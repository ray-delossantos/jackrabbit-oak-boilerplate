<!--/*
    VENTURE Navigation Component
    Main site navigation with mobile menu
*/-->
<sly data-sly-use.nav="com.aem.oak.models.navigation.NavigationModel"></sly>

<header class="venture-header">
    <nav class="venture-nav" aria-label="Main navigation">
        <div class="venture-nav__container">
            <!-- Logo -->
            <a href="${nav.homePath}.html" class="venture-nav__logo">
                <img src="${nav.logoPath}"
                     alt="${nav.logoAlt || 'Home'}"
                     data-sly-test="${nav.hasLogo}">
                <span data-sly-test="${!nav.hasLogo}">VENTURE</span>
            </a>

            <!-- Desktop Navigation -->
            <ul class="venture-nav__menu" data-sly-test="${nav.hasItems}">
                <sly data-sly-list.item="${nav.items}">
                    <li class="venture-nav__item ${item.hasChildren ? 'has-children' : ''} ${item.current ? 'current' : ''}">
                        <a href="${item.link}"
                           class="venture-nav__link ${item.active ? 'active' : ''}"
                           aria-current="${item.active ? 'page' : ''}">${item.title}</a>

                        <!-- Dropdown for children -->
                        <ul class="venture-nav__dropdown" data-sly-test="${item.hasChildren}">
                            <sly data-sly-list.child="${item.children}">
                                <li class="venture-nav__dropdown-item">
                                    <a href="${child.link}"
                                       class="venture-nav__dropdown-link ${child.active ? 'active' : ''}">${child.title}</a>
                                </li>
                            </sly>
                        </ul>
                    </li>
                </sly>
            </ul>

            <!-- Search Toggle -->
            <button class="venture-nav__search-toggle" aria-label="Toggle search">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                </svg>
            </button>

            <!-- Mobile Menu Toggle -->
            <button class="venture-nav__toggle" aria-label="Toggle menu" aria-expanded="false">
                <span class="venture-nav__toggle-icon"></span>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div class="venture-nav__mobile">
        <ul class="venture-nav__mobile-menu">
            <sly data-sly-list.item="${nav.items}">
                <li class="venture-nav__mobile-item ${item.hasChildren ? 'has-children' : ''}">
                    <a href="${item.link}" class="venture-nav__mobile-link">${item.title}</a>
                    <button class="venture-nav__mobile-expand"
                            aria-label="Expand submenu"
                            data-sly-test="${item.hasChildren}">+</button>

                    <ul class="venture-nav__mobile-submenu" data-sly-test="${item.hasChildren}">
                        <sly data-sly-list.child="${item.children}">
                            <li>
                                <a href="${child.link}" class="venture-nav__mobile-link">${child.title}</a>
                            </li>
                        </sly>
                    </ul>
                </li>
            </sly>
        </ul>
    </div>

    <!-- Search Overlay -->
    <div class="venture-nav__search-overlay">
        <form class="venture-nav__search-form" action="/content/venture/en/search.html" method="get">
            <input type="search"
                   name="q"
                   class="venture-nav__search-input"
                   placeholder="Search articles..."
                   aria-label="Search">
            <button type="submit" class="venture-nav__search-submit">Search</button>
            <button type="button" class="venture-nav__search-close" aria-label="Close search">&times;</button>
        </form>
    </div>
</header>

<style>
.venture-header {
    position: sticky;
    top: 0;
    z-index: 1000;
    background: #fff;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
}

.venture-nav__container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
    height: 70px;
}

.venture-nav__logo {
    display: flex;
    align-items: center;
    text-decoration: none;
    font-family: var(--venture-font-accent, 'Bebas Neue', sans-serif);
    font-size: 1.75rem;
    color: var(--venture-dark, #202020);
    letter-spacing: 0.05em;
}

.venture-nav__logo img {
    height: 40px;
    width: auto;
}

.venture-nav__menu {
    display: none;
    list-style: none;
    margin: 0;
    padding: 0;
    gap: 0.5rem;
}

@media (min-width: 992px) {
    .venture-nav__menu {
        display: flex;
    }
}

.venture-nav__item {
    position: relative;
}

.venture-nav__link {
    display: block;
    padding: 0.75rem 1rem;
    color: var(--venture-dark, #202020);
    text-decoration: none;
    font-weight: 500;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    transition: color 0.2s ease;
}

.venture-nav__link:hover,
.venture-nav__link.active {
    color: var(--venture-coral, #FF6B6B);
}

.venture-nav__item.current > .venture-nav__link {
    color: var(--venture-coral, #FF6B6B);
}

/* Dropdown */
.venture-nav__dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 200px;
    background: #fff;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    list-style: none;
    padding: 0.5rem 0;
    margin: 0;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all 0.2s ease;
}

.venture-nav__item:hover .venture-nav__dropdown {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.venture-nav__dropdown-link {
    display: block;
    padding: 0.625rem 1.25rem;
    color: #495057;
    text-decoration: none;
    font-size: 0.875rem;
    transition: all 0.2s ease;
}

.venture-nav__dropdown-link:hover {
    background: #f8f9fa;
    color: var(--venture-coral, #FF6B6B);
}

/* Search & Toggle Buttons */
.venture-nav__search-toggle,
.venture-nav__toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    background: none;
    border: none;
    cursor: pointer;
    color: var(--venture-dark, #202020);
}

.venture-nav__toggle {
    display: flex;
}

@media (min-width: 992px) {
    .venture-nav__toggle {
        display: none;
    }
}

.venture-nav__toggle-icon,
.venture-nav__toggle-icon::before,
.venture-nav__toggle-icon::after {
    display: block;
    width: 24px;
    height: 2px;
    background: currentColor;
    transition: all 0.3s ease;
}

.venture-nav__toggle-icon {
    position: relative;
}

.venture-nav__toggle-icon::before,
.venture-nav__toggle-icon::after {
    content: "";
    position: absolute;
    left: 0;
}

.venture-nav__toggle-icon::before { top: -7px; }
.venture-nav__toggle-icon::after { top: 7px; }

.venture-nav__toggle[aria-expanded="true"] .venture-nav__toggle-icon {
    background: transparent;
}

.venture-nav__toggle[aria-expanded="true"] .venture-nav__toggle-icon::before {
    transform: rotate(45deg);
    top: 0;
}

.venture-nav__toggle[aria-expanded="true"] .venture-nav__toggle-icon::after {
    transform: rotate(-45deg);
    top: 0;
}

/* Mobile Menu */
.venture-nav__mobile {
    display: none;
    position: fixed;
    top: 70px;
    left: 0;
    right: 0;
    bottom: 0;
    background: #fff;
    overflow-y: auto;
    padding: 1rem;
}

.venture-nav__mobile.active {
    display: block;
}

.venture-nav__mobile-menu {
    list-style: none;
    padding: 0;
    margin: 0;
}

.venture-nav__mobile-item {
    border-bottom: 1px solid #eee;
    display: flex;
    flex-wrap: wrap;
}

.venture-nav__mobile-link {
    flex: 1;
    display: block;
    padding: 1rem;
    color: var(--venture-dark, #202020);
    text-decoration: none;
    font-weight: 500;
}

.venture-nav__mobile-expand {
    width: 44px;
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: #6c757d;
}

.venture-nav__mobile-submenu {
    width: 100%;
    list-style: none;
    padding: 0 0 0 1rem;
    margin: 0;
    display: none;
    background: #f8f9fa;
}

.venture-nav__mobile-submenu.active {
    display: block;
}

/* Search Overlay */
.venture-nav__search-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.9);
    z-index: 9999;
    align-items: center;
    justify-content: center;
}

.venture-nav__search-overlay.active {
    display: flex;
}

.venture-nav__search-form {
    width: 90%;
    max-width: 600px;
    display: flex;
    gap: 1rem;
}

.venture-nav__search-input {
    flex: 1;
    padding: 1rem 1.5rem;
    font-size: 1.25rem;
    border: none;
    border-bottom: 2px solid var(--venture-yellow, #FFEA00);
    background: transparent;
    color: #fff;
    outline: none;
}

.venture-nav__search-input::placeholder {
    color: rgba(255, 255, 255, 0.5);
}

.venture-nav__search-submit {
    padding: 1rem 2rem;
    background: var(--venture-yellow, #FFEA00);
    color: var(--venture-dark, #202020);
    border: none;
    font-weight: 700;
    cursor: pointer;
}

.venture-nav__search-close {
    position: absolute;
    top: 2rem;
    right: 2rem;
    font-size: 2rem;
    color: #fff;
    background: none;
    border: none;
    cursor: pointer;
}
</style>

<script>
(function() {
    const toggle = document.querySelector('.venture-nav__toggle');
    const mobileMenu = document.querySelector('.venture-nav__mobile');
    const searchToggle = document.querySelector('.venture-nav__search-toggle');
    const searchOverlay = document.querySelector('.venture-nav__search-overlay');
    const searchClose = document.querySelector('.venture-nav__search-close');
    const mobileExpands = document.querySelectorAll('.venture-nav__mobile-expand');

    if (toggle && mobileMenu) {
        toggle.addEventListener('click', function() {
            const expanded = this.getAttribute('aria-expanded') === 'true';
            this.setAttribute('aria-expanded', !expanded);
            mobileMenu.classList.toggle('active');
            document.body.style.overflow = expanded ? '' : 'hidden';
        });
    }

    if (searchToggle && searchOverlay) {
        searchToggle.addEventListener('click', function() {
            searchOverlay.classList.add('active');
            searchOverlay.querySelector('input').focus();
        });

        searchClose.addEventListener('click', function() {
            searchOverlay.classList.remove('active');
        });

        searchOverlay.addEventListener('click', function(e) {
            if (e.target === searchOverlay) {
                searchOverlay.classList.remove('active');
            }
        });
    }

    mobileExpands.forEach(function(btn) {
        btn.addEventListener('click', function() {
            const submenu = this.nextElementSibling;
            submenu.classList.toggle('active');
            this.textContent = submenu.classList.contains('active') ? '-' : '+';
        });
    });
})();
</script>
